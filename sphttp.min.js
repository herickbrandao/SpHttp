var sphttp=function(e={}){e.baseURL||(e.baseURL="../"),e.headers||(e.headers={Accept:"application/json; odata=verbose"}),e.timeout||(e.timeout=8e3),e.headers=Object.assign({Accept:"application/json; odata=verbose"},e.headers);var t="",r=[],a=JSON.stringify(e);function n(e,t={}){return s(e,t).then(function(e){return e&&e.d&&e.d.results?e.d.results.map(function(e){return o(e)}):e&&e.d?o(e.d):e})}async function s(t,r,a=!1){"object"==typeof a&&a.cleanURL&&(e.baseURL="");let n=new AbortController,s=setTimeout(function(){return n.abort()},e.timeout),o=await fetch(e.baseURL+t,Object.assign({signal:n.signal,headers:e.headers},r)).then(async function(e){var t=!0;try{t=await e.json()}catch(r){return!0}return t}).then(function(e){if(e&&e["odata.error"]&&e["odata.error"].message&&e["odata.error"].message.value)throw e["odata.error"].message.value;if(e&&e.error&&e.error.message&&e.error.message.value)throw e.error.message.value;return e});return clearTimeout(s),o}function o(e,t=!0){var a={};if(r.join().length>0)for(var n in r)e[r[n]]?a[r[n]]=e[r[n]]:e[r[n].split("/")[0]]?(a[r[n].split("/")[0]]||(a[r[n].split("/")[0]]=[]),e[r[n].split("/")[0]].results&&!a[r[n].split("/")[0]].length?a[r[n].split("/")[0]].push.apply(a[r[n].split("/")[0]],e[r[n].split("/")[0]].results):e[r[n].split("/")[0]]&&e[r[n].split("/")[0]][r[n].split("/")[1]]&&(a[r[n].split("/")[0]][0]=e[r[n].split("/")[0]])):t&&(a[r[n]]=null);return r.join().length>0?a:e}function i(a={}){a.top||(a.top=5e3),a.select||(a.select=[]),a.expand||(a.expand=[]),"object"==typeof a.select&&(a.select=a.select.join()),"object"==typeof a.expand&&(a.expand=a.expand.join()),r=a.select.split(",");var i="_api/lists/getbytitle('"+t+"')/items",l="?";if(a.ID)return i+="("+a.ID+")",a.select&&a.select.length>0&&(i+=l+"$select="+a.select,l="&"),a.expand&&a.expand.length>0&&(i+=l+"$expand="+a.expand,l="&"),a.avoidcache&&(i+=l+"$v="+window.crypto.randomUUID(),l="&"),n(i);if(i+="?$top="+a.top,l="&",a.select&&a.select.length>0&&(i+=l+"$select="+a.select,l="&"),a.expand&&a.expand.length>0&&(i+=l+"$expand="+a.expand,l="&"),a.filter&&a.filter.length>0&&(i+=l+"$filter="+a.filter,l="&"),a.avoidcache&&(i+=l+"$v="+window.crypto.randomUUID(),l="&"),!a.recursive)return a.orderby&&a.orderby.length>0&&(i+=l+"$orderby="+a.orderby,l="&"),n(i);i=e.baseURL+i;var c=[];return new Promise(function(e,t){async function r(a){s(a,{},{cleanURL:!0}).then(async function(t){t&&t.d&&t.d.results?c.push.apply(c,t.d.results.map(function(e){return o(e)})):t&&t.d&&c.push.apply(c,o(t.d)),t&&t.d&&t.d.__next?await r(t.d.__next):e(c)}).catch(function(e){t(e)})}r(i)}).then(function(e){return c})}function l(r){return e.headers=Object.assign({Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value},e.headers),s("_api/lists/getbytitle('"+t+"')/items",{method:"POST",body:"object"==typeof r?JSON.stringify(r):r})}function c(r){e.headers=Object.assign({Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"IF-MATCH":"*","X-HTTP-Method":"MERGE"},e.headers);var a="_api/lists/getbytitle('"+t+"')/items";if("object"==typeof r&&r.ID)a+="("+r.ID+")";else throw"[ERROR] Put request data is wrong!";return s(a,{method:"POST",body:"object"==typeof r?JSON.stringify(r):r})}function p(r){e.headers=Object.assign({Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value},e.headers);var a="_api/lists/getbytitle('"+t+"')/items";if("object"==typeof r&&r.ID)a+="("+r.ID+")/recycle()";else throw"[ERROR] Recycle request data is wrong!";return s(a,{method:"POST",body:"object"==typeof r?JSON.stringify(r):r})}function d(r){e.headers=Object.assign({Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"IF-MATCH":"*","X-HTTP-Method":"DELETE"},e.headers);var a="_api/lists/getbytitle('"+t+"')/items";if("object"==typeof r&&r.ID)a+="("+r.ID+")";else if("number"==typeof r)a+="("+r+")";else throw"[ERROR] Delete request data is wrong!";return s(a,{method:"POST"})}function u(r={}){if(!window.FileReader)throw"[ERROR] Your browser does not have support for FileReader!";if(isNaN(r.ID))throw"[ERROR] List ID not found at attach request!";if(!r.target&&!r.delete)return n("_api/lists/getbytitle('"+t+"')/items("+r.ID+")/AttachmentFiles");var o=!!("string"==typeof r.target&&document.querySelector(r.target))&&document.querySelector(r.target).files,i=[];for(var l in o)"object"==typeof o[l]&&i.push(h(o[l]));return Promise.all(i).then(function(i){var l=[],c="";for(var p in i){e.headers=Object.assign(e.headers,{"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"content-length":i[p].byteLength}),new Uint8Array(i[p]);var d=o[p].name;c="_api/lists/GetByTitle('"+t+"')/items("+r.ID+")/AttachmentFiles/add(FileName='"+d+"')",l.push(s(c,{method:"POST",body:i[p]}))}return r.delete?((e=JSON.parse(a)).headers=Object.assign({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"X-HTTP-Method":"DELETE"},e.headers),n(c="_api/lists/GetByTitle('"+t+"')/items("+r.ID+")/AttachmentFiles/getByFileName('"+r.delete+"')",{method:"DELETE"})):Promise.all(l).then(function(e){for(var t in e)e[t]&&e[t].d&&(e[t]=e[t].d);return e})})}function h(e){return new Promise(function(t,r){try{var a=new FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){r(e.target.error)},a.readAsArrayBuffer(e)}catch(n){console.error("[ERROR] "+n),r(n)}})}async function f(e={}){e.top||(e.top=5e3),e.select&&!e.select.includes("ID")&&e.select.push("ID"),e.select||(e.select=[]),e.expand||(e.expand=[]),"object"==typeof e.select&&(e.select=e.select.join()),"object"==typeof e.expand&&(e.expand=e.expand.join());var a=[];a[0]=n("_api/lists/getbytitle('"+t+"')/items?$top=1&$select=Id&$orderby=Id asc"),a[1]=n("_api/lists/getbytitle('"+t+"')/items?$top=1&$select=Id&$orderby=Id desc");var s=await Promise.all(a);e.total=[],e.total[0]=s[0][0]&&s[0][0].Id?s[0][0].Id:0,e.total[1]=s[1][0]&&s[1][0].Id?s[1][0].Id:0,e.total[2]=e.total[1]-e.total[0]+1,e.total[3]=parseInt(e.total[2]/e.top)+1,r=e.select.split(",");var o="?$top="+e.top;e.select&&e.select.length>0&&(o+="&$select="+e.select),e.expand&&e.expand.length>0&&(o+="&$expand="+e.expand);var i=[];e.total[0]-=1;for(var l=0;l<e.total[3];l++){var c,p="_api/web/lists/getbytitle('"+t+"')/items"+o;l>0&&(e.total[0]+=e.top,p+="&$skiptoken=Paged%3dTRUE%26p_ID%3d"+e.total[0]),c=e.action&&"function"==typeof e.action?n(p).then(e.action):n(p),i.push(c)}var d=await Promise.all(i);let u=new Set;var h=[];for(var f of d){if(f.error){h=f;break}var y=f.filter(function(e){let t=u.has(e.ID);return u.add(e.ID),!t});h.push.apply(h,y)}return h}return{list:function r(n){return t=n,e=JSON.parse(a),{get:i,items:i,add:l,post:l,create:l,put:c,update:c,del:d,delete:d,recycle:p,attach:u,iterate:f}},user:function t(r=!1){switch(e=JSON.parse(a),typeof r){case"string":var s=[r.toLowerCase(),r.toUpperCase(),];let o=s[0],i=o.split(" ");for(var l=0;l<i.length;l++)i[l]=i[l].charAt(0).toUpperCase()+i[l].slice(1);s[2]=i.join(" "),s[3]=r.normalize("NFD").replace(/[\u0300-\u036f]/g,"");var c="_api/web/siteusers?$filter=(";return c+="(startswith(Title,'"+s[0]+"')) or ",c+="(startswith(Title,'"+s[1]+"')) or ",c+="(startswith(Title,'"+s[3]+"')) or ",n(c+="(startswith(Title,'"+s[2]+"')))");case"number":return n("_api/Web/SiteUserInfoList/Items("+r+")");case"object":if(r.ID)return n("_api/web/GetUserById("+r.ID+")/Groups");break;case"boolean":return n("_api/Web/CurrentUser?$expand=groups")}throw"[ERROR] User Request Failed!"},attach:function t(r={}){if(!window.FileReader)throw"[ERROR] Your browser does not have support for FileReader!";if(!r.library)throw"[ERROR] List library not found at attach request!";if(r.name?r.startswith||(r.tname="('"+r.name+"')"):r.tname="",!r.target&&!r.delete)return r.startswith&&r.name&&(r.tname="?$filter=startswith(Name,'"+r.name+"')"),n("_api/web/GetFolderByServerRelativeUrl('"+r.library+"')/Files"+r.tname);var o=!!("string"==typeof r.target&&document.querySelector(r.target))&&document.querySelector(r.target).files,i=[];for(var l in o)"object"==typeof o[l]&&i.push(h(o[l]));return Promise.all(i).then(function(t){var i=[],l="";for(var c in t){e.headers=Object.assign({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"content-length":t[c].byteLength},e.headers),new Uint8Array(t[c]);var p=r.name?r.name:o[c].name;l="_api/web/GetFolderByServerRelativeUrl('"+r.library+"')/Files/Add(url='"+p+"', overwrite=true)",i.push(s(l,{method:"POST",body:t[c]}))}if("string"==typeof r.delete&&r.delete&&r.delete.length>0)return(e=JSON.parse(a)).headers=Object.assign({"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"X-HTTP-Method":"DELETE"},e.headers),l="_api/web/getfilebyserverrelativeurl('"+r.library+"/"+r.delete+"')",r.recycle&&!0==r.recycle&&(l+="/recycle()"),n(l,{method:"POST"});if(r.delete)throw"[ERROR] Filename is missing!";return Promise.all(i).then(function(e){for(var t in e)e[t]&&e[t].d&&(e[t]=e[t].d);return e})})},rest:n,fetch:s,version:"0.4.1"}};