const SpHttp=function(e={}){e.baseURL||(e.baseURL="../"),e.headers||(e.headers={Accept:"application/json; odata=verbose"}),e.timeout||(e.timeout=8e3),e.headers=Object.assign({Accept:"application/json; odata=verbose"},e.headers);var t="",r=[],a=JSON.stringify(e);function n(e,t={}){return o(e,t).then(function(e){return e&&e.d&&e.d.results?e.d.results.map(function(e){return s(e)}):e&&e.d?s(e.d):e})}async function o(t,r,a=!1){"object"==typeof a&&a.cleanURL&&(e.baseURL="");const n=new AbortController,o=setTimeout(function(){return n.abort()},e.timeout),s=await fetch(e.baseURL+t,Object.assign({signal:n.signal,headers:e.headers},r)).then(async function(e){var t=!0;try{t=await e.json()}catch(e){return!0}return t}).then(function(e){return e&&e["odata.error"]&&e["odata.error"].message&&e["odata.error"].message.value?{error:e["odata.error"].message.value}:e&&e.error&&e.error.message&&e.error.message.value?{error:e.error.message.value}:e}).catch(function(e){return{error:{message:e}}});return clearTimeout(o),s}function s(e,t=!0){var a={};if(r.join().length>0)for(key in r)e[r[key]]?a[r[key]]=e[r[key]]:t&&(a[r[key]]=null);return r.join().length>0?a:e}function c(a={}){a.top||(a.top=5e3),a.select||(a.select=[]),a.expand||(a.expand=[]),"object"==typeof a.select&&(a.select=a.select.join()),"object"==typeof a.expand&&(a.expand=a.expand.join()),r=a.select.split(",");var i="_api/lists/getbytitle('"+t+"')/items",c="?";if(a.ID)return i+="("+a.ID+")",a.select&&a.select.length>0&&(i+=c+"$select="+a.select,c="&"),a.expand&&a.expand.length>0&&(i+=c+"$expand="+a.expand,c="&",r=[""]),n(i);if(i+="?$top="+a.top,c="&",a.select&&a.select.length>0&&(i+=c+"$select="+a.select,c="&"),a.expand&&a.expand.length>0&&(i+=c+"$expand="+a.expand,c="&",r=[""]),!a.recursive)return a.filter&&a.filter.length>0&&(i+=c+"$filter="+a.filter,c="&"),a.orderby&&a.orderby.length>0&&(i+=c+"$orderby="+a.orderby,c="&"),n(i);i=e.baseURL+i;var u=[];return new Promise(function(e,t){!async function r(a){o(a,{},{cleanURL:!0}).then(async function(t){t&&t.d&&t.d.results?u.push.apply(u,t.d.results.map(function(e){return s(e)})):t&&t.d&&u.push.apply(u,s(t.d)),t&&t.d&&t.d.__next?await r(t.d.__next):e(u)}).catch(function(e){t(e)})}(i)}).then(function(e){return u})}function u(r){return e.headers=Object.assign(e.headers,{Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value}),o("_api/lists/getbytitle('"+t+"')/items",{method:"POST",body:"object"==typeof r?JSON.stringify(r):r})}function l(r){e.headers=Object.assign(e.headers,{Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"IF-MATCH":"*","X-HTTP-Method":"MERGE"});var a="_api/lists/getbytitle('"+t+"')/items";return"object"==typeof r&&r.ID?o(a+="("+r.ID+")",{method:"POST",body:"object"==typeof r?JSON.stringify(r):r}):(console.error("[ERROR] Put request data is wrong!"),{error:"[ERROR] Put request data is wrong!"})}function d(r){e.headers=Object.assign(e.headers,{Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"IF-MATCH":"*","X-HTTP-Method":"DELETE"});var a="_api/lists/getbytitle('"+t+"')/items";if("object"==typeof r&&r.ID)a+="("+r.ID+")";else{if("number"!=typeof r)return console.error("[ERROR] Delete request data is wrong!"),{error:"[ERROR] Delete request data is wrong!"};a+="("+r+")"}return o(a,{method:"POST"})}function p(r={}){if(!window.FileReader)return{error:"[ERROR] Your browser does not have support for FileReader!"};if(isNaN(r.ID))return{error:"[ERROR] List ID not found at attach request!"};if(!r.target&&!r.delete)return n("_api/lists/getbytitle('"+t+"')/items("+r.ID+")/AttachmentFiles");var s=!("string"!=typeof r.target||!document.querySelector(r.target))&&document.querySelector(r.target).files,c=[];for(i in s)"object"==typeof s[i]&&c.push(f(s[i]));return Promise.all(c).then(function(c){var u=[],l="";for(i in c){e.headers=Object.assign(e.headers,{"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"content-length":c[i].byteLength});new Uint8Array(c[i]);var d=s[i].name;l="_api/lists/GetByTitle('"+t+"')/items("+r.ID+")/AttachmentFiles/add(FileName='"+d+"')",u.push(o(l,{method:"POST",body:c[i]}))}return r.delete?((e=JSON.parse(a)).headers=Object.assign(e.headers,{"X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"X-HTTP-Method":"DELETE"}),n(l="_api/lists/GetByTitle('"+t+"')/items("+r.ID+")/AttachmentFiles/getByFileName('"+r.delete+"')",{method:"DELETE"})):Promise.all(u)})}function f(e){return new Promise(function(t,r){try{var a=new FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){r({error:e.target.error})},a.readAsArrayBuffer(e)}catch(e){console.error("[ERROR] "+e),r({error:e})}})}return{list:function(r){return t=r,e=JSON.parse(a),{get:c,items:c,add:u,post:u,create:u,put:l,update:l,del:d,delete:d,attach:p}},user:function(t=!1){switch(e=JSON.parse(a),typeof t){case"string":var r=[t.toLowerCase(),t.toUpperCase()];const i=r[0].split(" ");for(var o=0;o<i.length;o++)i[o]=i[o].charAt(0).toUpperCase()+i[o].slice(1);r[2]=i.join(" "),r[3]=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"");var s="_api/web/siteusers?$filter=(";return s+="(startswith(Title,'"+r[0]+"')) or ",s+="(startswith(Title,'"+r[1]+"')) or ",s+="(startswith(Title,'"+r[3]+"')) or ",n(s+="(startswith(Title,'"+r[2]+"')))");case"number":return n("_api/Web/SiteUserInfoList/Items("+t+")");case"object":if(t.ID)return n("_api/web/GetUserById("+t.ID+")/Groups");break;case"boolean":return n("_api/Web/CurrentUser?$expand=groups")}return console.error("[ERROR] User Request Failed!"),{error:"[ERROR] User Request Failed!"}},version:"0.0.22"}};