const SpHttp=function(e={}){e.baseURL||(e.baseURL="../"),e.headers||(e.headers={Accept:"application/json; odata=verbose"}),e.timeout||(e.timeout=8e3),e.headers=Object.assign({Accept:"application/json; odata=verbose"},e.headers);var t="",r=[];function n(e,t={}){return a(e,t).then(function(e){return e&&e.d&&e.d.results?e.d.results.map(function(e){return s(e)}):e&&e.d?s(e.d):e})}async function a(t,r,n=!1){"object"==typeof n&&n.cleanURL&&(e.baseURL="");const a=new AbortController,s=setTimeout(function(){return a.abort()},e.timeout),o=await fetch(e.baseURL+t,Object.assign({signal:a.signal,headers:e.headers},r)).then(function(t){return!!e.headers["X-HTTP-Method"]||t.json()}).then(function(e){return e&&e["odata.error"]&&e["odata.error"].message&&e["odata.error"].message.value?{error:e["odata.error"].message.value}:e&&e.error&&e.error.message&&e.error.message.value?{error:e.error.message.value}:e}).catch(function(e){return{error:{message:e}}});return clearTimeout(s),o}function s(e,t=!0){var n={};for(key in r)e[r[key]]?n[r[key]]=e[r[key]]:t&&(n[r[key]]=null);return r.length>0?n:e}function o(o={}){o.top||(o.top=5e3),o.select||(o.select=[]),o.expand||(o.expand=[]),"object"==typeof o.select&&(o.select=o.select.join()),"object"==typeof o.expand&&(o.expand=o.expand.join()),r=o.select.split(",");var i="_api/lists/getbytitle('"+t+"')/items",c="?";if(o.ID)return i+="("+o.ID+")",o.select&&o.select.length>0&&(i+=c+"$select="+o.select,c="&"),o.expand&&o.expand.length>0&&(i+=c+"$expand="+o.expand,c="&"),n(i);if(i+="?$top="+o.top,c="&",o.select&&o.select.length>0&&(i+=c+"$select="+o.select,c="&"),o.expand&&o.expand.length>0&&(i+=c+"$expand="+o.expand,c="&"),!o.recursive)return n(i);i=e.baseURL+i;var u=[];return new Promise(function(e,t){!async function r(n){a(n,{},{cleanURL:!0}).then(async function(t){t&&t.d&&t.d.results?u.push.apply(u,t.d.results.map(function(e){return s(e)})):t&&t.d&&u.push.apply(u,s(t.d)),t&&t.d&&t.d.__next?await r(t.d.__next):e(u)}).catch(function(e){t(e)})}(i)}).then(function(e){return u})}function i(r){return e.headers=Object.assign(e.headers,{Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value}),a("_api/lists/getbytitle('"+t+"')/items",{method:"POST",body:"object"==typeof r?JSON.stringify(r):r})}function c(r){e.headers=Object.assign(e.headers,{Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"IF-MATCH":"*","X-HTTP-Method":"MERGE"});var n="_api/lists/getbytitle('"+t+"')/items";return"object"==typeof r&&r.ID?a(n+="("+r.ID+")",{method:"POST",body:"object"==typeof r?JSON.stringify(r):r}):(console.error("[ERROR] Put request data is wrong!"),{error:"[ERROR] Put request data is wrong!"})}function u(r){e.headers=Object.assign(e.headers,{Accept:"application/json; odata=nometadata","Content-Type":"application/json;odata=nometadata","X-RequestDigest":document.querySelector("#__REQUESTDIGEST").value,"IF-MATCH":"*","X-HTTP-Method":"DELETE"});var n="_api/lists/getbytitle('"+t+"')/items";if("object"==typeof r&&r.ID)n+="("+r.ID+")";else{if("number"!=typeof r)return console.error("[ERROR] Delete request data is wrong!"),{error:"[ERROR] Delete request data is wrong!"};n+="("+r+")"}return a(n,{method:"POST"})}return{list:function(e){return t=e,{get:o,post:i,put:c,update:c,del:u,delete:u}},user:function(e=!1){switch(typeof e){case"string":return n("/_api/web/siteusers?$filter=startswith(Title,'"+e+"')");case"number":return n("_api/Web/SiteUserInfoList/Items("+e+")");case"object":if(e.ID)return n("_api/web/GetUserById("+e.ID+")/Groups");break;case"boolean":return n("_api/Web/CurrentUser?$expand=groups")}return console.error("[ERROR] User Request Failed!"),{error:"[ERROR] User Request Failed!"}},rest:n}};